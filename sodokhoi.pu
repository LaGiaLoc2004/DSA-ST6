@startuml
' --- CẤU HÌNH GIAO DIỆN ---
skinparam classAttributeIconSize 0
skinparam monochrome true
skinparam linetype ortho
skinparam packageStyle rectangle
scale 0.9

' --- 1. NHÓM DỮ LIỆU NỀN TẢNG ---
package "1. Cấu trúc Dữ liệu & Mô hình" {
    class "MyStack<T>" {
        - items : T?[]
        - top : int
        + Capacity : int <<get>>
        --
        + MyStack(capacity)
        + Push(item)
        + Pop() : T
        + Peek() : T
        + IsEmpty() : bool
        + IsFull() : bool
        + Count() : int
        + Clear()
        + ToArray() : T[]
    }

    class Move {
        + From : char
        + To : char
        + Disk : int
        + ToString() : string
    }

    class StableItem {
        + Value : int
        + OriginalIndex : int
        + CompareTo() : int
    }

    interface "ITraversable<T>" {
        + HasNext() : bool
        + Next() : T
    }

    class "ArrayTraversable<T>" {
        - data : T[]
        - index : int
        + HasNext() : bool
        + Next() : T
    }
    
    "ITraversable<T>" <|.. "ArrayTraversable<T>"
}

' --- 2. NHÓM THUẬT TOÁN ---
package "2. Thuật toán Xử lý" {
    class ThuanToanSapXep {
        + {static} InsertionSort<T>(stack)
        + {static} SelectionSort<T>(stack)
        + {static} MergeSort<T>(stack) : MyStack<T>
        - {static} Merge<T>(left, right) : MyStack<T>
    }

    class ThuatToanTimKiem {
        ' Class bao ngoài
    }

    class "BFSFinder<T>" {
        - chieuVao : MyStack<T>
        - chieuRa : MyStack<T>
        + Search(origin, target) : bool
    }

    class "DFSFinder<T>" {
        + Search(origin, target) : bool
    }

    class "LinearSearchFinder<T>" {
        + Search(origin, target) : bool
    }

    ThuatToanTimKiem +-- "BFSFinder<T>"
    ThuatToanTimKiem +-- "DFSFinder<T>"
    ThuatToanTimKiem +-- "LinearSearchFinder<T>"
}

' --- 3. NHÓM ĐO LƯỜNG & TIỆN ÍCH ---
package "3. Công cụ Đo lường & Hỗ trợ" {
    class DataGenerator <<static>> {
        + {static} TaoStackNgauNhien(size)
        + {static} TaoStackTangDan(size)
        + {static} TaoStackGiamDan(size)
    }

    class Timing {
        - startingTime : TimeSpan
        - duration : TimeSpan
        + startTime()
        + StopTime()
        + Result() : TimeSpan
    }

    abstract class TimeAnalyzer {
        # n : int
        # Measure(action) : double[]
        # PrintResult(name, times)
    }

    class TimeSort {
        - size : int
        + TimeSort(n, size)
        + RunAll()
    }

    class TimeSearch {
        - size : int
        + TimeSearch(n, size)
        + Run()
    }

    TimeAnalyzer <|-- TimeSort
    TimeAnalyzer <|-- TimeSearch
    TimeAnalyzer ..> Timing : uses
}

' --- 4. NHÓM ỨNG DỤNG ---
package "4. Ứng dụng Thực tế" {
    class HanoiUsingStack {
        - src, aux, dest : MyStack<int>
        + Steps : List<string>
        + Moves : List<Move>
        + SolveIterative(n)
        - MoveDisk(...)
    }

    class StabilityEvaluation {
        + {static} Evaluate(n)
        - {static} IsStable(stack) : bool
    }

    class Program <<static>> {
        - {static} Main()
    }
}

' --- ĐỊNH NGHĨA QUAN HỆ (VẼ SAU CÙNG ĐỂ BỐ CỤC ĐẸP) ---

' Quan hệ Thuật toán -> Dữ liệu
ThuanToanSapXep ..> "MyStack<T>" : thao tác
"BFSFinder<T>" ..> "ITraversable<T>" : duyệt
"BFSFinder<T>" --> "MyStack<T>" : dùng 2 stack

' Quan hệ Ứng dụng -> Dữ liệu
HanoiUsingStack --> "MyStack<T>" : có 3 cọc
HanoiUsingStack ..> Move : tạo danh sách
StabilityEvaluation ..> StableItem : kiểm tra

' Quan hệ Đo lường -> Thuật toán & Tiện ích
TimeSort ..> ThuanToanSapXep : đo
TimeSort ..> DataGenerator : lấy dữ liệu
TimeSearch ..> ThuatToanTimKiem : đo
TimeSearch ..> DataGenerator : lấy dữ liệu
StabilityEvaluation ..> ThuanToanSapXep : kiểm tra ổn định

@enduml
