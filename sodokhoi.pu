@startuml

' --- CẤU HÌNH GIAO DIỆN ---
skinparam classAttributeIconSize 0
skinparam monochrome true
skinparam packageStyle rectangle
skinparam linetype ortho
scale 0.9

' --- GROUP 1: CÁC FILE CẤU TRÚC DỮ LIỆU ---

package "Interface.cs" {
    interface "ITraversable<T>" {
        + HasNext() : bool
        + Next() : T
    }
    
    class "ArrayTraversable<T>" {
        + ArrayTraversable(data : T[])
        + HasNext() : bool
        + Next() : T
    }
}

package "MyStack.cs" {
    class "MyStack<T>" {
        + Count : int <<get>>
        + Capacity : int <<get>>
        --
        + MyStack(capacity : int)
        + Push(item : T)
        + Pop() : T
        + Peek() : T
        + IsEmpty() : bool
        + IsFull() : bool
        + Clear()
        + Contains(item : T) : bool
        + ToArray() : T[]
        + Display()
    }
}

' --- GROUP 2: CÁC FILE MÔ HÌNH (MODELS) ---

package "Move.cs" {
    class Move {
        + From : char
        + To : char
        + Disk : int
        --
        + Move(from, to, disk)
        + ToString() : string
    }
}

package "Stable.cs" {
    class StableItem {
        + Value : int <<get set>>
        + OriginalIndex : int <<get set>>
        --
        + CompareTo(other : StableItem?) : int
    }
    
    class StabilityEvaluation {
        + {static} Evaluate(n : int)
    }
}

package "Random.cs" {
    class "DataGenerator" <<static>> {
        + {static} TaoStackNgauNhien(size) : MyStack<int>
        + {static} TaoStackTangDan(size) : MyStack<int>
        + {static} TaoStackGiamDan(size) : MyStack<int>
    }
}

' --- GROUP 3: CÁC FILE THUẬT TOÁN ---

package "ThuatToanSapXep.cs" {
    class ThuatToanSapXep {
        + {static} InsertionSort<T>(stack: MyStack<T>)
        + {static} SelectionSort<T>(stack: MyStack<T>)
        + {static} MergeSort<T>(stack: MyStack<T>) : MyStack<T>
    }
}

package "ThuatToanTimKiem.cs" {
    class ThuatToanTimKiem {
        ' Container class
    }
    class "BFSFinder<T>"
    class "DFSFinder<T>" 
    class "LinearSearchFinder<T>"
    
    ThuatToanTimKiem +-- "BFSFinder<T>"
    ThuatToanTimKiem +-- "DFSFinder<T>"
    ThuatToanTimKiem +-- "LinearSearchFinder<T>"
}

' --- GROUP 4: CÁC FILE ĐO LƯỜNG (TIMING) ---

package "Timing.cs" {
    class Timing {
        + startTime()
        + StopTime()
        + Result() : TimeSpan
    }
}

package "TimeAnalyzer.cs" {
    abstract class TimeAnalyzer {
        ' Base class
    }
}

package "TimeSort.cs" {
    class TimeSort {
        + TimeSort(n, size)
        + RunAll()
    }
}

package "TimeSearch.cs" {
    class TimeSearch {
        + TimeSearch(n, size)
        + Run()
    }
}

' --- GROUP 5: APP & MAIN ---

package "HanoiUsingStack.cs" {
    class HanoiUsingStack {
        + Steps : List<string> <<get>>
        + Moves : List<Move> <<get>>
        --
        + HanoiUsingStack()
        + SolveIterative(n : int)
    }
}

package "Program.cs" {
    class Program <<static>> {
        + {static} Main()
    }
}

' --- ĐỊNH NGHĨA QUAN HỆ ---

' 1. Quan hệ thực thi
"ITraversable<T>" <|.. "ArrayTraversable<T>"
TimeAnalyzer <|-- TimeSort
TimeAnalyzer <|-- TimeSearch

' 2. Quan hệ phụ thuộc chính
ThuatToanSapXep ..> "MyStack<T>"
"BFSFinder<T>" ..> "ITraversable<T>"

DataGenerator ..> "MyStack<T>" : creates

HanoiUsingStack ..> "MyStack<T>"
HanoiUsingStack --> Move

' 3. Quan hệ đo lường
TimeSort ..> ThuatToanSapXep
TimeSort ..> DataGenerator
TimeSort ..> Timing

TimeSearch ..> ThuatToanTimKiem
TimeSearch ..> DataGenerator
TimeSearch ..> Timing

' 4. Quan hệ Stability
StabilityEvaluation ..> StableItem
StabilityEvaluation ..> ThuatToanSapXep

' 5. Program chạy tất cả
Program ..> HanoiUsingStack
Program ..> TimeSort
Program ..> TimeSearch
Program ..> StabilityEvaluation

@enduml